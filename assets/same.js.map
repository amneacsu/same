{"version":3,"sources":["webpack:///same.js","webpack:///webpack/bootstrap 76dcdad7c8a410a00fa7","webpack:///./src/same.js","webpack:///./src/game.js","webpack:///./src/canvas.js","webpack:///./src/x.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_game","_canvas","_x2","width","height","score","bonus","hasProps","props","cell","Object","keys","every","prop","self","item","compact","list","filter","find","grid","rand","b","Math","random","match","unmatch","remove","splice","indexOf","moveRight","x","moveDown","y","spaceBelow","column","row","randomCell","matched","fall","collapseColumns","length","x2","forEach","applyGravity","tick","render","gameToCanvas","window","requestAnimationFrame","neighbours","cells","n","matchCells","arguments","undefined","push","points","click","move","handle","action","e","cellOffset","canvas","addEventListener","defineProperty","value","fills","twoPI","PI","erase","context","clearRect","drawScore","fillStyle","fillText","drawCell","circle","radius","beginPath","arc","closePath","fill","document","getElementById","getContext","font","state","cellSize","map","offsetX","offsetY"],"mappings":"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","file":"same.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _game = __webpack_require__(1);\n\t\n\tvar _canvas = __webpack_require__(2);\n\t\n\tvar _x2 = __webpack_require__(3);\n\t\n\tvar width = 11,\n\t    height = 12;\n\t\n\tvar score = 0,\n\t    bonus = 0;\n\t\n\tvar hasProps = function hasProps(props) {\n\t  return function (cell) {\n\t    return Object.keys(props).every(function (prop) {\n\t      return cell[prop] === props[prop];\n\t    });\n\t  };\n\t};\n\tvar self = function self(item) {\n\t  return item;\n\t};\n\tvar compact = function compact(list) {\n\t  return list.filter(self);\n\t};\n\tvar find = function find(list, props) {\n\t  return list.find(hasProps(props));\n\t};\n\tvar filter = function filter(props) {\n\t  return _game.grid.filter(hasProps(props));\n\t};\n\tvar rand = function rand(b) {\n\t  return ~ ~(Math.random() * b);\n\t};\n\tvar match = function match(cell) {\n\t  return cell.m = true;\n\t};\n\tvar unmatch = function unmatch(cell) {\n\t  return cell.m = false;\n\t};\n\tvar remove = function remove(cell) {\n\t  return _game.grid.splice(_game.grid.indexOf(cell), 1);\n\t};\n\tvar moveRight = function moveRight(cell) {\n\t  return cell.x += 1;\n\t};\n\tvar moveDown = function moveDown(cell) {\n\t  return cell.y += 1;\n\t};\n\t\n\tvar spaceBelow = function spaceBelow(cell) {\n\t  return !find(_game.grid, { x: cell.x, y: cell.y + 1 });\n\t};\n\tvar column = function column(x) {\n\t  return filter({ x: x });\n\t};\n\tvar row = function row(y) {\n\t  return filter({ y: y });\n\t};\n\t\n\tvar randomCell = function randomCell(x, y) {\n\t  var c = rand(5),\n\t      matched = false;\n\t  return { x: x, y: y, c: c, matched: matched };\n\t};\n\t\n\tvar fall = function fall(cell) {\n\t  while (cell.y < height && spaceBelow(cell)) {\n\t    moveDown(cell);\n\t  }\n\t};\n\t\n\tvar collapseColumns = function collapseColumns() {\n\t  for (var x = width; x >= 2; x--) {\n\t    if (column(x).length) continue;\n\t\n\t    for (var x2 = x - 1; x2 >= 1; x2--) {\n\t      column(x2).forEach(moveRight);\n\t    }\n\t  }\n\t};\n\t\n\tvar applyGravity = function applyGravity() {\n\t  for (var y = height; y >= 1; y--) {\n\t    row(y).forEach(fall);\n\t  }\n\t};\n\t\n\tvar tick = function tick() {\n\t  (0, _canvas.render)((0, _x2.gameToCanvas)(_game.grid, score, bonus));\n\t  window.requestAnimationFrame(tick);\n\t};\n\t\n\tvar neighbours = function neighbours(cell) {\n\t  var cells = filter({ c: cell.c });\n\t\n\t  var n = [find(cells, { x: cell.x, y: cell.y + 1 }), find(cells, { x: cell.x, y: cell.y - 1 }), find(cells, { x: cell.x + 1, y: cell.y }), find(cells, { x: cell.x - 1, y: cell.y })];\n\t\n\t  return compact(n);\n\t};\n\t\n\tvar matchCells = function matchCells(cell) {\n\t  var list = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];\n\t\n\t  list.push(cell);\n\t\n\t  neighbours(cell).forEach(function (c) {\n\t    if (list.indexOf(c) === -1) matchCells(c, list);\n\t  });\n\t\n\t  return list;\n\t};\n\t\n\tvar points = function points(matched) {\n\t  return matched.length * (matched.length - 1);\n\t};\n\t\n\tvar click = function click(cell) {\n\t  var matched = matchCells(cell);\n\t\n\t  if (matched.length >= 2) {\n\t    score += points(matched);\n\t    matched.forEach(remove);\n\t    applyGravity();\n\t    collapseColumns();\n\t  }\n\t};\n\t\n\tvar move = function move(cell) {\n\t  _game.grid.forEach(unmatch);\n\t  var matched = matchCells(cell);\n\t\n\t  if (matched.length >= 2) {\n\t    matched.forEach(match);\n\t    bonus = points(matched);\n\t  }\n\t};\n\t\n\tvar handle = function handle(action) {\n\t  return function (e) {\n\t    var cell = find(_game.grid, (0, _x2.cellOffset)(e));\n\t    cell && action(cell, e);\n\t  };\n\t};\n\t\n\t_canvas.canvas.addEventListener('click', handle(click));\n\t_canvas.canvas.addEventListener('click', handle(move));\n\t_canvas.canvas.addEventListener('mousemove', handle(move));\n\twindow.addEventListener('load', tick);\n\t\n\tfor (var y = 1; y <= height; y++) {\n\t  for (var x = 1; x <= width; x++) {\n\t    _game.grid.push(randomCell(x, y));\n\t  }\n\t}\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar grid = [];\n\t\n\texports.grid = grid;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar fills = ['#8C3', '#FD0', '#F0E', '#4AF', '#F04'];\n\tvar twoPI = 2 * Math.PI;\n\t\n\tvar erase = function erase() {\n\t  return context.clearRect(0, 0, canvas.width, canvas.height);\n\t};\n\t\n\tvar drawScore = function drawScore(score) {\n\t  context.fillStyle = '#432';\n\t  context.fillText(score, 5, 610);\n\t};\n\t\n\tvar drawCell = function drawCell(cell) {\n\t  context.fillStyle = fills[cell.fillStyle];\n\t  circle(cell.x, cell.y, cell.radius);\n\t};\n\t\n\tvar circle = function circle(x, y, radius) {\n\t  context.beginPath();\n\t  context.arc(x, y, radius, 0, twoPI, false);\n\t  context.closePath();\n\t  context.fill();\n\t};\n\t\n\tvar canvas = exports.canvas = document.getElementById('same');\n\tvar context = exports.context = canvas.getContext('2d');\n\tcontext.font = '24px sans-serif';\n\t\n\tvar render = exports.render = function render(state) {\n\t  erase();\n\t  state.cells.forEach(drawCell);\n\t  drawScore(state.score);\n\t};\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar cellSize = 48;\n\t\n\tvar drawCell = function drawCell(cell) {\n\t  var x = (cell.x - 0.5) * cellSize;\n\t  var y = (cell.y - 0.5) * cellSize;\n\t  var radius = cellSize * (cell.m ? 0.25 : 0.4);\n\t  var fillStyle = cell.c;\n\t\n\t  return { x: x, y: y, radius: radius, fillStyle: fillStyle };\n\t};\n\t\n\tvar gameToCanvas = exports.gameToCanvas = function gameToCanvas(grid, score, bonus) {\n\t  return {\n\t    cells: grid.map(drawCell),\n\t    score: 'Score: ' + score + (bonus > 0 ? ' + ' + bonus : '')\n\t  };\n\t};\n\t\n\tvar cellOffset = exports.cellOffset = function cellOffset(e) {\n\t  return {\n\t    x: ~ ~(e.offsetX / cellSize) + 1,\n\t    y: ~ ~(e.offsetY / cellSize) + 1\n\t  };\n\t};\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** same.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 76dcdad7c8a410a00fa7\n **/","import { grid } from './game';\nimport { canvas, context, render } from './canvas';\nimport { gameToCanvas, cellOffset } from './x';\n\nconst\n  width = 11,\n  height = 12;\n\nlet score = 0, bonus = 0;\n\nconst hasProps = (props) => (cell) => Object.keys(props).every((prop) => cell[prop] === props[prop]);\nconst self = (item) => item;\nconst compact = (list) => list.filter(self);\nconst find = (list, props) => list.find(hasProps(props));\nconst filter = (props) => grid.filter(hasProps(props));\nconst rand = (b) => ~~(Math.random() * b);\nconst match = (cell) => cell.m = true;\nconst unmatch = (cell) => cell.m = false;\nconst remove = (cell) => grid.splice(grid.indexOf(cell), 1);\nconst moveRight = (cell) => cell.x += 1;\nconst moveDown = (cell) => cell.y += 1;\n\nconst spaceBelow = (cell) => !find(grid, {x: cell.x, y: cell.y + 1});\nconst column = (x) => filter({x});\nconst row = (y) => filter({y});\n\nconst randomCell = (x, y) => {\n  let c = rand(5), matched = false;\n  return {x, y, c, matched};\n};\n\nconst fall = (cell) => {\n  while (cell.y < height && spaceBelow(cell)) moveDown(cell);\n};\n\nconst collapseColumns = () => {\n  for (let x = width; x >= 2; x--) {\n    if (column(x).length) continue;\n\n    for (let x2 = x - 1; x2 >= 1; x2--) {\n      column(x2).forEach(moveRight);\n    }\n  }\n};\n\nconst applyGravity = () => {\n  for (let y = height; y >= 1; y--) {\n    row(y).forEach(fall);\n  }\n}\n\nconst tick = function() {\n  render(gameToCanvas(grid, score, bonus));\n  window.requestAnimationFrame(tick);\n}\n\nconst neighbours = (cell) => {\n  let cells = filter({c: cell.c});\n\n  let n = [\n    find(cells, {x: cell.x, y: cell.y + 1}),\n    find(cells, {x: cell.x, y: cell.y - 1}),\n    find(cells, {x: cell.x + 1, y: cell.y}),\n    find(cells, {x: cell.x - 1, y: cell.y})\n  ];\n\n  return compact(n);\n}\n\nconst matchCells = function(cell, list = []) {\n  list.push(cell);\n\n  neighbours(cell).forEach(function(c) {\n    if (list.indexOf(c) === -1) matchCells(c, list);\n  });\n\n  return list;\n}\n\nconst points = (matched) => matched.length * (matched.length - 1);\n\nconst click = cell => {\n  let matched = matchCells(cell);\n\n  if (matched.length >= 2) {\n    score += points(matched);\n    matched.forEach(remove);\n    applyGravity();\n    collapseColumns();\n  }\n}\n\nconst move = cell => {\n  grid.forEach(unmatch);\n  let matched = matchCells(cell);\n\n  if (matched.length >= 2) {\n    matched.forEach(match);\n    bonus = points(matched);\n  }\n}\n\nconst handle = action => {\n  return e => {\n    let cell = find(grid, cellOffset(e));\n    cell && action(cell, e);\n  }\n}\n\ncanvas.addEventListener('click', handle(click));\ncanvas.addEventListener('click', handle(move));\ncanvas.addEventListener('mousemove', handle(move));\nwindow.addEventListener('load', tick);\n\nfor (let y = 1; y <= height; y++) {\n  for (let x = 1; x <= width; x++) {\n    grid.push(randomCell(x, y));\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/same.js\n **/","const grid = [];\n\nexport {\n  grid\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/game.js\n **/","const fills = ['#8C3', '#FD0', '#F0E', '#4AF', '#F04'];\nconst twoPI = 2 * Math.PI;\n\nconst erase = () => context.clearRect(0, 0, canvas.width, canvas.height);\n\nconst drawScore = (score) => {\n  context.fillStyle = '#432';\n  context.fillText(score, 5, 610);\n}\n\nconst drawCell = (cell) => {\n  context.fillStyle = fills[cell.fillStyle];\n  circle(cell.x, cell.y, cell.radius);\n};\n\nconst circle = (x, y, radius) => {\n  context.beginPath();\n  context.arc(x, y, radius, 0, twoPI, false);\n  context.closePath();\n  context.fill();\n}\n\nexport const canvas = document.getElementById('same');\nexport const context = canvas.getContext('2d');\ncontext.font = '24px sans-serif';\n\nexport const render = state => {\n  erase();\n  state.cells.forEach(drawCell);\n  drawScore(state.score);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/canvas.js\n **/","const cellSize = 48;\n\nconst drawCell = (cell) => {\n  let x = (cell.x - 0.5) * cellSize;\n  let y = (cell.y - 0.5) * cellSize;\n  let radius = cellSize * (cell.m ? 0.25 : 0.4);\n  let fillStyle = cell.c;\n\n  return { x, y, radius, fillStyle };\n};\n\nexport const gameToCanvas = function(grid, score, bonus) {\n  return {\n    cells: grid.map(drawCell),\n    score: `Score: ${score}` + (bonus > 0 ? ` + ${bonus}` : '')\n  };\n}\n\nexport const cellOffset = function(e) {\n  return {\n    x: ~~(e.offsetX / cellSize) + 1,\n    y: ~~(e.offsetY / cellSize) + 1\n  };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/x.js\n **/"],"sourceRoot":""}